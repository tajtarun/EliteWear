<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin Panel ‚Äî EliteWear</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  font-family:'Poppins',sans-serif;
  background:#0b0b0c;
  color:#fff;
  padding:40px;
}
input{
  display:block;
  margin-bottom:15px;
  padding:10px;
  width:300px;
}
button{
  padding:10px 20px;
  cursor:pointer;
}
</style>
</head>
<body>

<h2>Add Product</h2>

<input type="text" id="productName" placeholder="Product Name">
<input type="number" id="productPrice" placeholder="Product Price">
<input type="file" id="productImage">
<button onclick="addProduct()">Upload Product</button>

<p id="status"></p>

<script>

/* üî¥ PASTE YOUR VALUES HERE */
const supabaseUrl = "https://vxcoanhvcglxbpxsvsxv.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ4Y29hbmh2Y2dseGJweHN2c3h2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2MTk4NjgsImV4cCI6MjA4MzE5NTg2OH0.RIx4Yfy74CWWr7vvoh2R5CcFn9Mz6oTw3nsNWkzuRTw";

const sb = window.supabase.createClient(supabaseUrl, supabaseKey);

async function addProduct() {

  const name = document.getElementById("productName").value.trim();
  const price = document.getElementById("productPrice").value.trim();
  const file = document.getElementById("productImage").files[0];
  const status = document.getElementById("status");

  if (!name || !price || !file) {
    status.innerText = "Fill all fields.";
    return;
  }

  status.innerText = "Uploading image...";

  const fileName = Date.now() + "_" + file.name;

  // 1Ô∏è‚É£ Upload image to bucket
  const { error: uploadError } = await sb
    .storage
    .from("products")
    .upload(fileName, file);

  if (uploadError) {
    console.error(uploadError);
    status.innerText = "Image upload failed.";
    return;
  }

  // 2Ô∏è‚É£ Get public URL
  const { data } = sb
    .storage
    .from("products")
    .getPublicUrl(fileName);

  const imageUrl = data.publicUrl;

  // 3Ô∏è‚É£ Insert into database
  status.innerText = "Saving product...";

  const { error: insertError } = await sb
    .from("products")
    .insert([
      {
        product_name: name,
        product_price: price,
        image_url: imageUrl
      }
    ]);

  if (insertError) {
    console.error(insertError);
    status.innerText = "Database insert failed.";
    return;
  }

  status.innerText = "Product added successfully!";

  // Clear form
  document.getElementById("productName").value = "";
  document.getElementById("productPrice").value = "";
  document.getElementById("productImage").value = "";
}

</script>

</body>
</html>
